# Git Merge 충돌 해결 실습 문제와 답

## 🎯 목표
터미널에서 본 오류 상황을 이해하고 해결할 수 있도록 실습합니다.

```
$ git merge origin/main
Updating f291627..b048e06
error: Your local changes to the following files would be overwritten by merge:
        README.md
Please commit your changes or stash them before you merge.
```

---

## 📝 문제 1: 기본 이해 문제

### 문제 1-1
**질문:** 위 오류 메시지가 나타나는 이유는 무엇인가요?

**답:**
```
로컬 작업 디렉토리에 커밋되지 않은 변경사항이 있고,
원격 저장소(origin/main)에서도 같은 파일(README.md)이 수정되어
Git이 자동으로 병합할 수 없기 때문입니다.

Git은 안전을 위해 충돌 가능성이 있는 merge를 차단합니다.
```

### 문제 1-2
**질문:** 이 문제를 해결하는 3가지 방법을 나열하세요.

**답:**
```
1. 커밋 후 Merge: 로컬 변경사항을 커밋한 후 merge
2. Stash 사용: 로컬 변경사항을 임시 저장(stash)한 후 merge하고 다시 적용
3. 변경사항 버리기: 로컬 변경사항을 버리고 원격 변경사항만 사용
```

---

## 📝 문제 2: 커밋 후 Merge (가장 권장)

### 문제 2-1
**질문:** 로컬 변경사항을 보존하면서 원격 변경사항을 가져오는 전체 과정을 명령어로 작성하세요.

**답:**
```bash
# 1단계: 현재 상태 확인
git status

# 2단계: 변경사항 스테이징
git add README.md

# 3단계: 커밋
git commit -m "로컬 README.md 수정사항"

# 4단계: 원격 저장소 최신 정보 가져오기
git fetch origin

# 5단계: Merge 실행
git merge origin/main

# 6단계: 충돌 발생 시 (같은 부분 수정한 경우)
#        - README.md 파일 열어서 충돌 해결
#        - git add README.md
#        - git commit -m "Merge origin/main and resolve conflicts"
```

### 문제 2-2
**질문:** Merge 후 README.md에 다음과 같은 충돌 마커가 나타났습니다. 어떻게 해결하나요?

```markdown
<<<<<<< HEAD
로컬에서 추가한 내용
=======
원격에서 추가한 내용
>>>>>>> origin/main
```

**답:**
```markdown
# 두 변경사항을 모두 보존하는 경우:
로컬에서 추가한 내용
원격에서 추가한 내용

# 또는 하나만 선택하는 경우:
원격에서 추가한 내용  # (로컬 내용 버림)

# 또는 순서를 바꾸는 경우:
원격에서 추가한 내용
로컬에서 추가한 내용
```

**해결 후 명령어:**
```bash
git add README.md
git commit -m "충돌 해결: 로컬과 원격 변경사항 병합"
```

---

## 📝 문제 3: Stash 사용

### 문제 3-1
**질문:** 아직 완성되지 않은 작업을 임시 저장하고 merge하는 과정을 작성하세요.

**답:**
```bash
# 1단계: 변경사항을 stash에 저장
git stash save "README.md 작업 중"

# 2단계: Stash 목록 확인
git stash list

# 3단계: 원격 저장소 최신 정보 가져오기
git fetch origin

# 4단계: Merge 실행
git merge origin/main

# 5단계: Stash한 변경사항 다시 적용
git stash pop

# 6단계: 충돌 발생 시 해결
#        - README.md 파일에서 충돌 해결
#        - git add README.md
#        - git commit -m "Stash 적용 및 충돌 해결"
```

### 문제 3-2
**질문:** 다음 stash 목록이 있습니다. 두 번째 stash를 삭제하는 방법은?

```
stash@{0}: WIP on main: abc1234 최근 작업
stash@{1}: WIP on main: def5678 이전 작업
stash@{2}: WIP on main: ghi9012 오래된 작업
```

**답:**
```bash
# 특정 stash 삭제
git stash drop stash@{1}

# 또는 인덱스로 삭제 (두 번째 = 인덱스 1)
git stash drop stash@{1}

# 확인
git stash list
# 결과:
# stash@{0}: WIP on main: abc1234 최근 작업
# stash@{1}: WIP on main: ghi9012 오래된 작업
```

---

## 📝 문제 4: 변경사항 버리기 (주의!)

### 문제 4-1
**질문:** 로컬 변경사항이 불필요해서 원격 버전만 사용하고 싶을 때의 명령어는?

**답:**
```bash
# 방법 1: 특정 파일만 되돌리기
git checkout -- README.md

# 방법 2: 모든 변경사항 되돌리기
git checkout -- .

# 방법 3: 특정 커밋 상태로 되돌리기
git checkout HEAD -- README.md

# 그 다음 merge
git fetch origin
git merge origin/main
```

### 문제 4-2
**질문:** 실수로 `git checkout -- README.md`를 실행했습니다. 복구 방법은?

**답:**
```bash
# 방법 1: Git reflog 사용
git reflog
# 출력에서 이전 상태의 커밋 해시 찾기
git checkout <commit-hash> -- README.md

# 방법 2: IDE의 로컬 히스토리 사용 (VSCode 등)
# - 파일 우클릭 > Local History > 이전 버전 복구

# 방법 3: Stash가 있었다면
git stash list
git stash show stash@{0}
git stash apply stash@{0}
```

**주의:** `git checkout --` 명령은 되돌릴 수 없으므로 신중하게 사용하세요!

---

## 📝 문제 5: 실제 시나리오 해결

### 문제 5-1
**상황:**
- README.md에 "로컬에서 작업 중" 추가
- 원격에는 "원격에서 작업 완료" 추가  
- 두 변경사항 모두 보존하고 싶음

**해결 과정을 단계별로 작성하세요.**

**답:**
```bash
# 1단계: 현재 상태 확인
git status
# 출력: README.md가 modified로 표시됨

# 2단계: 로컬 변경사항 커밋
git add README.md
git commit -m "로컬 작업 추가"

# 3단계: 원격 저장소 정보 가져오기
git fetch origin

# 4단계: 원격 변경사항 미리 확인 (선택사항)
git diff main origin/main -- README.md

# 5단계: Merge 실행
git merge origin/main

# 6단계: 충돌 발생 - README.md 파일 열기
# 파일 내용:
# <<<<<<< HEAD
# 로컬에서 작업 중
# =======
# 원격에서 작업 완료
# >>>>>>> origin/main

# 7단계: 충돌 해결 - 두 내용 모두 보존
# 수정 후:
# 로컬에서 작업 중
# 원격에서 작업 완료

# 8단계: 해결 완료 후 커밋
git add README.md
git commit -m "로컬과 원격 변경사항 병합"

# 9단계: 결과 확인
git log --oneline --graph -5
```

### 문제 5-2
**상황:**
- README.md 작업 중인데 아직 완성 안 됨
- 원격 변경사항을 먼저 가져와야 함
- 나중에 작업 계속하고 싶음

**해결 과정을 작성하세요.**

**답:**
```bash
# 1단계: 현재 작업 임시 저장
git stash save "README.md 작업 중 - 나중에 계속"

# 2단계: 작업 디렉토리 깨끗해짐 확인
git status
# 출력: "working tree clean"

# 3단계: 원격 저장소 정보 가져오기
git fetch origin

# 4단계: Merge 실행
git merge origin/main

# 5단계: Stash한 작업 다시 적용
git stash pop

# 6단계: 충돌 발생 가능 - 해결
# README.md에서 충돌 마커 확인 및 해결

# 7단계: 충돌 해결 후 커밋
git add README.md
git commit -m "원격 변경사항 merge 후 로컬 작업 계속"
```

---

## 📝 문제 6: 고급 문제

### 문제 6-1
**질문:** 여러 파일에 변경사항이 있는데, 일부만 커밋하고 나머지는 stash하고 싶습니다. 어떻게 하나요?

**답:**
```bash
# 방법 1: 특정 파일만 커밋
git add README.md
git commit -m "README.md 변경사항"

# 나머지 파일은 stash
git stash save -u "기타 변경사항"
# -u 옵션: untracked files도 포함

# 방법 2: 인터랙티브 스테이징 사용
git add -p README.md  # 부분적으로만 스테이징
git commit -m "README.md 일부 변경사항"
git stash save "나머지 변경사항"
```

### 문제 6-2
**질문:** Merge 전에 원격 변경사항을 미리 확인하는 방법은?

**답:**
```bash
# 1. 원격 정보 가져오기 (merge 없이)
git fetch origin

# 2. 전체 차이 확인
git diff main origin/main

# 3. 특정 파일만 확인
git diff main origin/main -- README.md

# 4. 원격 파일 내용 직접 보기
git show origin/main:README.md

# 5. 어떤 파일이 변경되었는지 확인
git diff --name-only main origin/main

# 6. 통계로 확인
git diff --stat main origin/main
```

---

## 📝 문제 7: 실전 문제

### 문제 7-1
**질문:** 다음 명령어 순서가 올바른가요? 틀렸다면 수정하세요.

```bash
git merge origin/main
git add README.md
git commit -m "변경사항"
```

**답:**
```
❌ 틀렸습니다!

올바른 순서:
1. git add README.md        # 먼저 변경사항 스테이징
2. git commit -m "변경사항"  # 커밋
3. git fetch origin         # 원격 정보 가져오기 (선택사항이지만 권장)
4. git merge origin/main    # 그 다음 merge

또는:
1. git stash save "임시"     # 변경사항 임시 저장
2. git fetch origin
3. git merge origin/main    # merge
4. git stash pop            # 변경사항 다시 적용
```

### 문제 7-2
**질문:** Merge 후 충돌 해결이 완료되었는지 확인하는 방법은?

**답:**
```bash
# 1. 상태 확인
git status

# 충돌이 해결되지 않으면:
# "Unmerged paths:" 섹션에 파일 목록이 나타남
# 예: "both modified: README.md"

# 충돌이 모두 해결되면:
# "All conflicts fixed but you are still merging."
# 또는 "nothing to commit, working tree clean"

# 2. 충돌 마커 검색 (수동 확인)
grep -r "<<<<<<< HEAD" .  # Linux/Mac
findstr /s /c:"<<<<<<< HEAD" *.*  # Windows

# 3. Merge 완료 확인
git log --oneline --graph -5
# merge commit이 보이면 완료

# 4. 최종 확인
git status
# "Your branch is ahead of 'origin/main' by X commits" 또는
# "Your branch is up to date with 'origin/main'"
```

---

## 📝 종합 문제

### 종합 문제 1: 완전한 워크플로우

**상황:**
1. 로컬에서 README.md에 "로컬 작업" 추가
2. 다른 개발자가 원격에 "원격 작업" push
3. 두 변경사항 모두 보존하고 싶음
4. 충돌 발생 예상

**전체 해결 과정을 단계별로 작성하세요.**

**답:**
```bash
# ============================================
# 1단계: 현재 상태 파악
# ============================================
git status
# 출력: README.md modified

git log --oneline -3
# 최근 커밋 히스토리 확인

# ============================================
# 2단계: 로컬 변경사항 커밋
# ============================================
git add README.md
git commit -m "로컬 README.md에 작업 내용 추가"

# ============================================
# 3단계: 원격 저장소 정보 가져오기
# ============================================
git fetch origin

# ============================================
# 4단계: 원격 변경사항 미리 확인 (선택사항)
# ============================================
git diff main origin/main -- README.md
# 또는
git show origin/main:README.md

# ============================================
# 5단계: Merge 실행
# ============================================
git merge origin/main

# ============================================
# 6단계: 충돌 발생 및 해결
# ============================================
# README.md 파일 열기
# 충돌 마커 확인:
# <<<<<<< HEAD
# 로컬 작업
# =======
# 원격 작업
# >>>>>>> origin/main

# 수정: 두 내용 모두 보존
# 로컬 작업
# 원격 작업

# ============================================
# 7단계: 충돌 해결 완료 및 커밋
# ============================================
git add README.md
git status
# "All conflicts fixed but you are still merging."

git commit -m "Merge origin/main: 로컬과 원격 변경사항 병합"

# ============================================
# 8단계: 결과 확인
# ============================================
git log --oneline --graph -5
# merge commit이 보임

git status
# "Your branch is ahead of 'origin/main' by X commits"

# ============================================
# 9단계: (선택사항) 원격에 push
# ============================================
git push origin main
```

### 종합 문제 2: 여러 해결 방법 비교

**상황:** README.md에 "로컬 작업" 추가했는데, 원격에 "원격 작업" 추가됨

**각 해결 방법의 결과를 표로 정리하세요.**

**답:**

| 방법 | README.md 최종 내용 | 커밋 히스토리 | 장점 | 단점 |
|------|-------------------|--------------|------|------|
| **커밋 후 Merge** | "로컬 작업"<br>"원격 작업"<br>(충돌 해결 필요) | 1. 로컬 커밋<br>2. Merge 커밋<br>3. 충돌 해결 커밋 | 히스토리 추적 용이<br>안전함 | 커밋이 많아짐 |
| **Stash 사용** | "로컬 작업"<br>"원격 작업"<br>(충돌 해결 필요) | 1. Merge 커밋<br>2. Stash 적용 커밋 | 히스토리 깔끔<br>임시 작업 보관 | Stash 관리 필요 |
| **변경사항 버리기** | "원격 작업"만<br>(로컬 작업 손실) | 1. Merge 커밋 | 빠름 | 데이터 손실 |

**권장 방법:** 커밋 후 Merge (히스토리 추적과 안전성)

---

## ✅ 자가 진단 체크리스트

다음 질문에 답할 수 있나요?

- [ ] Git merge 충돌 오류의 원인을 설명할 수 있나요?
- [ ] 커밋 후 merge 방법을 단계별로 실행할 수 있나요?
- [ ] Stash를 사용하여 임시 저장하고 다시 적용할 수 있나요?
- [ ] 충돌 마커(`<<<<<<<`, `=======`, `>>>>>>>`)를 해석하고 해결할 수 있나요?
- [ ] Merge 전에 원격 변경사항을 미리 확인할 수 있나요?
- [ ] 실수로 버린 변경사항을 복구할 수 있나요?
- [ ] 여러 해결 방법의 장단점을 비교하고 상황에 맞게 선택할 수 있나요?
- [ ] Merge 후 충돌 해결이 완료되었는지 확인할 수 있나요?

---

## 📚 추가 학습 자료

- `merge_solution_guide.md` - 상세한 해결 가이드
- `merge_practice_problems.md` - 추가 연습 문제
- `git_merge_test_scenario.md` - 테스트 시나리오
- `test_merge_scenario.bat` (Windows) 또는 `test_merge_scenario.sh` (Linux/Mac) - 실행 스크립트
